<!DOCTYPE html>
<div id="root"></div>
<script type="module">
  import { test, assert } from "./lib.js";
  import { Root, html } from "../html.js";

  test(() => {
    const r = Root.appendInto(root);

    const createPart = () => ({
      sequence: [],
      create(node) {
        assert.eq(node.tagName, "DIV");
        this.sequence.push("create");
      },
      update() {
        this.sequence.push("update");
      },
      detach() {
        this.sequence.push("detach");
      },
    });

    const part1 = createPart();
    const part2 = createPart();

    const template = (part) => html`<div ${part}>Hello, world!</div>`;

    r.render(template(part1));
    assert.deepEq(part1.sequence, ["create"]);
    part1.sequence.length = 0;

    r.render(template(part2));
    assert.deepEq(part1.sequence, ["detach"]);
    assert.deepEq(part2.sequence, ["create"]);
  });
</script>
