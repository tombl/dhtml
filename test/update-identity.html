<!doctype html>
<div id="root"></div>
<script type="module">
	import { test, assert } from './lib.js'
	import { Root, html } from '../html.js'

	test(() => {
		const template = n => html`<h1>Hello, ${n}!</h1>`
		const template2 = n => html`<h1>Hello, ${n}!</h1>`

		const r = Root.appendInto(document.getElementById('root'))

		r.render(template(1))
		assert.eq(root.innerHTML, '<h1>Hello, 1!</h1>')
		let [h1] = root.children

		r.render(template(2))
		assert.eq(root.innerHTML, '<h1>Hello, 2!</h1>')
		assert.eq(root.children[0], h1)

		r.render(template2(3))
		assert.eq(root.innerHTML, '<h1>Hello, 3!</h1>')
		assert(root.children[0] !== h1)
		;[h1] = root.children

		r.render(template2(template(template('inner'))))
		assert.eq(root.innerHTML, '<h1>Hello, <h1>Hello, <h1>Hello, inner!</h1>!</h1>!</h1>')
		assert.eq(root.children[0], h1)
	})
</script>
